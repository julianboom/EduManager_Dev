@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>

    @RenderPage("~/Views/Share/bootstrap.cshtml")
    <link href="~/Resource/plugins/radio/css/jquery-labelauty.css" rel="stylesheet" />
    <script src="~/Resource/plugins/radio/js/jquery-labelauty.js"></script>
    <style>
        li {
            list-style: none;
        }

        .labelauty-checked, .labelauty-unchecked {
            font-size: 12px !important;
        }

        .dowebok li label {
            padding: 7px 10px !important;
        }
    </style>
</head>
<body>
    <div class="mySearch">
        <div class="row">
            <div class="col-xs-1">
                <label class="">姓名：</label>
            </div>
            <div class="col-xs-2">
                <input autocomplete = "off" type="text" name="PersonName" id="qry_PersonName" class="form-control" />
            </div>
            <div class="col-xs-1">
                <label class="">所在单位：</label>
            </div>
            <div class="col-xs-2">
                <input autocomplete = "off" class="form-control" name="PersonUnit" id="qry_PersonUnit">
            </div>
            <div class="col-xs-1">
                <label class="">处理机关：</label>
            </div>
            <div class="col-xs-2">
                <input autocomplete = "off" type="text" name="FilingUnit" id="qry_FilingUnit" class="form-control" />
            </div>
            <div class="col-xs-1">
                <label class="">调整方式：</label>
            </div>
            <div class="col-xs-2">
                <input autocomplete = "off" type="text" name="AdjustType" id="qry_AdjustType" class="form-control" />
            </div>
        </div>
        <div class="row margin-top-10">
            <div class="col-xs-1">
                <label class="" for="AdjustTime">调整时间：</label>
            </div>
            <div class="col-xs-2">
                <input autocomplete = "off" placeholder="起止日期" class="form-control layer-date" style="width:100% !important;display:inline-block" id="ins1">
            </div>
            <div class="col-xs-1">
                <label>数据补全：</label>
            </div>
            <div class="col-xs-2">
                <select id="buquan" class="form-control selectpicker">
                    <option value=""></option>
                    <option value="未完善信息">未完善信息</option>
                    <option value="未关联干部">未关联干部</option>
                    <option value="未上传附件">未上传附件</option>
                    <option value="已上传附件">已上传附件</option>
                </select>
            </div>
            <div class="col-xs-6" style="text-align:right">
                <button type="button" class="layui-btn" onclick="Create()"><i class="layui-icon"></i></button>

                <button class="layui-btn layuiadmin-btn-list" onclick="queryDataGrid()">
                    <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>
                </button>
                <button class="layui-btn layui-btn-primary layuiadmin-btn-list" onclick="myClear()">
                    <i class="layui-icon layui-icon-refresh-1 layuiadmin-button-btn"></i>
                </button>
            </div>
        </div>
       
    </div>



    <div class="margin-top-10">
        <table id="AdjustList_table" class="table table-striped table-no-bordered table-hover" ></table>
    </div>
    <div id="pageNamber1" style="position:absolute;bottom:14px;text-align:center;right:300px;display:none">
        <label style="font-weight:500">跳转到</label>
        <input autocomplete = "off" value="1" id="pageNamber" class="form-control" style="width:40px;text-align:center;height:30px;display:inline-block" />
        <label style="font-weight:500">页</label>
    </div>
    @RenderPage("~/Views/Share/delConfirm.cshtml")
</body>
</html>

<script type="text/javascript">
    var SearchHeight = $(".mySearch").height();
    console.log(SearchHeight);
    $('#AdjustList_table').bootstrapTable({
        height: $(window).height() - SearchHeight-25,
        url: '/Adjust/GetAdjustInfoList',
        method: 'get',
        toolbar: '#toolbar',    //工具按钮用哪个容器
        striped: true,      //是否显示行间隔色
        cache: false,      //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
        pagination: true,     //是否显示分页（*）
        sortName: "AdjustTime",
        sortOrder: "desc",
        pageNumber: 1,      //初始化加载第一页，默认第一页
        pageSize: 100,      //每页的记录行数（*）
        pageList: [10, 25, 50, 100],  //可供选择的每页的行数（*）
        queryParamsType: '', //默认值为 'limit' ,在默认情况下 传给服务端的参数为：offset,limit,sort
        sidePagination: "server",   //分页方式：client客户端分页，server服务端分页（*）
        strictSearch: true,
        minimumCountColumns: 2,    //最少允许的列数
        clickToSelect: true,    //是否启用点击选中行
        queryParams: function (params) {

            return {
                sort: params.sortName,     //排序方式
                order: params.sortOrder,
                keyword1: $('#qry_PersonName').val(),
                keyword2: $('#qry_PersonUnit').val(),
                keyword3: $('#qry_FilingUnit').val(),
                keyword4: $('#qry_AdjustType').val(),
                keyword5: $('#start').val(),
                keyword6: $('#end').val(),
                buquan: $("#buquan").val(),
                //keyword7: $("input[type=checkbox]:checked").length <= 0 ? "" : $("input[type=checkbox]:checked").val(),
                pageSize: params.pageSize,
                pageNumber: params.pageNumber,
            }
        },
        columns: [
            { field: 'AdjustTime', title: '调整时间', width: 50, editable: false, formatter: IfEmpty, sortable: true},
            { field: 'PersonName', title: '姓名', width: 50, editable: false, formatter: IfEmpty, sortable: true },
            { field: 'PersonUnit', title: '所在单位', width: 100, editable: false, formatter: IfEmpty, sortable: true },
            { field: 'FilingUnit', title: '处理机关', width: 100, editable: false, formatter: IfEmpty, sortable: true},
            { field: 'AdjustType', title: '调整方式', width: 100, editable: false, formatter: IfEmpty, sortable: true},
            { field: 'opt', title: '操作', width: 90, editable: false, formatter: operateFormatterAdjust },
        ],
    });
    function operateFormatterAdjust(value, row, index) {
        return [
            '<button  onclick="LayerModal(\'编辑\',\'/Adjust/Edit?ID=' + row.ID + '\')" id="btn_detail" type="button" class="layui-btn layui-btn-sm" style="margin-right:10px">编辑</button>',
            '<a  href="javascript:deleteByID(\'' + row.ID + '\')" id="btn_detail" type="button" class="layui-btn layui-btn-danger layui-btn-sm" style="margin-right:10px">删除</a>',
        ].join('');
    }
    $('table').on('load-success.bs.table', function (data) {
        console.log("load success");
        $("[data-toggle='tooltip']").tooltip();
        var a = $('table').bootstrapTable('getData');
        //console.log(a);
        if (a.length > 0) {
            $("#pageNamber1").css("display", "block");
        }
    });
    $(function () {
        //$('input[type=checkbox]').labelauty();
        $("#pageNamber").change(function () {
            $('table').bootstrapTable('refresh', {
                pageNumber: $("#pageNamber").val(),
            });
        })
    });
    function queryDataGrid() {
        $('#AdjustList_table').bootstrapTable('refresh', {
            pageNumber: 1,
        });
    }
    function myClear() {
        $('#qry_PersonName').val("");
        $('#qry_PersonUnit').val("");
        $('#qry_FilingUnit').val("");
        $('#qry_AdjustType').val("");
        $('#start').val("");
        $('#end').val("");
        $('#ins1').val("");
        $('#IsEmpty').val("");
        queryDataGrid();
    };
    function Create() {

        LayerModal("新增", "/Adjust/AdjustInfoCreate");

    }

    function deleteByID(id) {
        $('#id').val(id);//给会话中的隐藏属性URL赋值
        $('#idName').val("ID");
        $('#backMsg').val("AdjustList_table");
        $('#urlDel').val("/Adjust/Delete");
        $('#urlBack').val("/Adjust/GetAdjustInfoList");
        $('#delcfmModel').modal();
    }


</script>
