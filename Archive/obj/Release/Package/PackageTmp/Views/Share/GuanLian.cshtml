@using Model;
@{
    Layout = null;
    Person person = ViewBag.person;

}

<style>
    .window, .window-shadow {
        top: 10px !important;
    }
    .modal-dialog{
        margin:10px auto;
    }
    .modal-dialog .modal-body{
        padding-bottom:0px;
    }
</style>
<form>
    <div class="row">
        <div class="row">
            <div class="col-xs-2 margin-top-10">
                <label class="margin-5" for="name">姓名：</label>
            </div>
            <div class="col-xs-2 margin-top-10">
                <input readonly class="form-control" type="text" id="Name" name="Name" value="@person.Name" />
            </div>
            <div class="col-xs-2 margin-top-10">

            </div>
            <div class="col-xs-6 margin-top-10" style="float:left !important">
                <button type="button" class="btn btn-primary " style="border:1px #cccccc solid;padding:8px 20px;border-radius:5px" data-toggle="modal" data-target="#myModal" onclick="startLoad()">选择干部</button>
                <button type="button" class="btn btn-primary " style="border:1px #cccccc solid;padding:8px 20px;border-radius:5px" onclick="quxiaobangding()">取消绑定</button>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-2 margin-top-10">
                <label class="margin-5" for="WorkUnit">所在单位：</label>
            </div>
            <div class="col-xs-2 margin-top-10">
                <input readonly class="form-control" type="text" value="@person.WorkUnit" name="WorkUnit" id="WorkUnit" />
            </div>
            <div class="col-xs-2 margin-top-10">
                <label class="margin-5" for="WorkDuty">职务：</label>
            </div>
            <div class="col-xs-2 margin-top-10">
                <input readonly class="form-control" type="text" id="WorkDuty" name="WorkDuty" value="@person.WorkDuty" />
            </div>
            <input style="display:none" id="ID1" value="@person.ID" />
            <input style="display:none" id="WorkUnit" value="@person.WorkUnit" />
        </div>

    </div>
@*添加弹窗*@
    <div class="modal fade" id="myModal">
        <div class="modal-dialog" style="width:800px;height:447px">
            <div class="modal-content message_align">
                <div class="modal-header" style="padding:10px 15px">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                    <h4 class="modal-title">选择干部</h4>
                </div>
                <div class="modal-body">
                        <div class="row">
                            <div class="col-xs-1">
                                <label class="margin-5">姓名：</label>
                            </div>
                            <div class="col-xs-3">
                                <input type="text" name="PersonName" id="qry_PersonName" class="form-control" />
                            </div>
                            <div class="col-xs-2">
                                <label class="margin-5">工作单位：</label>
                            </div>
                            <div class="col-xs-3">
                                <input type="text" name="WorkUnit" id="qry_WorkUnit" class="form-control" />
                            </div>
                            <div class="col-xs-1" style="height:34px;">
                            </div>
                            <div class="col-xs-2">
                                <button class="layui-btn" type="button" onclick="clear2()">清空</button>
                                <button class="layui-btn" type="button" onclick="queryDataGrid()">查询</button>
                            </div>
                        </div>
                        <table id="PersonList_table" class="table table-striped table-hover "></table>
                    </div>
                <div class="modal-footer" style="padding:10px 15px">
                    <button type="button" class="layui-btn layui-btn-primary layui-btn-sm" data-dismiss="modal">取消</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    
</form>
<script>
    //function select() {
    //    var selected = $('#PersonList_table').datagrid('getSelected');
    //    if (selected) {
    //        //alert(selected.Name)
    //        $("#Name").val(selected.Name);
    //        $("#PersonID").val(selected.ID);
    //        $("#ID1").val(selected.ID);
    //        $("#WorkUnit").val(selected.WorkUnit);
    //        $("#WorkDuty").val(selected.WorkDuty);
    //        //alert(selected.WorkUnit + ","+selected.WorkDuty)
    //    }
    //}
    function clear2(){
        $("#qry_PersonName").val("");
        $("#qry_WorkUnit").val("");
        queryDataGrid();
    }
    function queryDataGrid() {
        $('#PersonList_table').bootstrapTable('refresh', {
            pageNumber: 1,
        });
    }
    function startLoad() {
        $('#PersonList_table').bootstrapTable({
            height: 300,
            method: 'post',
            url: '/Person/GetAllPersonList',
            method: 'get',
            toolbar: '#toolbar',    //工具按钮用哪个容器
            striped: true,      //是否显示行间隔色
            cache: false,      //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
            pagination: true,     //是否显示分页（*）
            sortable: false,      //是否启用排序
            sortOrder: "asc",     //排序方式
            pageNumber: 1,      //初始化加载第一页，默认第一页
            pageSize: 5,      //每页的记录行数（*）
            pageList: [5,10, 25, 50, 100],  //可供选择的每页的行数（*）
            queryParamsType: '', //默认值为 'limit' ,在默认情况下 传给服务端的参数为：offset,limit,sort
            sidePagination: "server",   //分页方式：client客户端分页，server服务端分页（*）
            strictSearch: true,
            minimumCountColumns: 2,    //最少允许的列数
            clickToSelect: true,    //是否启用点击选中行
            queryParams: function (params) {
                return {
                    sort: "Name",     //排序方式
                    order: "asc",
                    keyword1: $('#qry_PersonName').val(),
                    keyword2: $('#qry_WorkUnit').val(),
                    keyword4: $("input[type=radio]:checked").val(),
                    pageSize: params.pageSize,
                    pageNumber: params.pageNumber,
                }
            },
            columns: [
                { field: 'Name', title: '姓名', width: 50, editable: false, },
                { field: 'WorkUnit', title: '工作单位', width: 100, editable: false, },
                { field: 'WorkDuty', title: '职务', width: 80, editable: false, },
                { field: 'opt', title: '操作', width: 10, editable: false, formatter: operateFormatterPersonList },
            ],
        });
        function operateFormatterPersonList(value, row, index) {
            return [
                '<a  onclick=mySelect(\'' + row.ID + '\',\'' + row.Name + '\',\'' + row.WorkUnit + '\',\'' + row.WorkDuty + '\') id="btn_detail" type="button" class="layui-btn layui-btn-danger layui-btn-xs"><span class="glyphicon glyphicon-check"></span>选择</a>',
            ].join('');
        }
       
    }
    function quxiaobangding() {
        $("#Name").val("");
        $("#PersonID").val("00000000-0000-0000-0000-000000000000");
        $("#ID1").val("00000000-0000-0000-0000-000000000000");
        $("#WorkUnit").val("");
        $("#WorkDuty").val("");
    }
    function mySelect(ID, Name, WorkUnit, WorkDuty) {
        $("#Name").val(Name);
        $("#PersonID").val(ID);
        $("#ID1").val(ID);
        $("#WorkUnit").val(WorkUnit);
        $("#WorkDuty").val(WorkDuty);
        $('#myModal').modal('hide');
    }
</script>