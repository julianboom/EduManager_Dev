@using BLL;
@using Model;
@{

    Layout = null;
}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
        @RenderPage("~/Views/Share/bootstrap.cshtml")
    <link href="~/Resource/plugins/bootstrap-treeview/css/bootstrap-treeview.css" rel="stylesheet" />
    <script src="~/Resource/plugins/bootstrap-treeview/js/bootstrap-treeview.js"></script>
<style>
    .glyphicon-stop::before {
        content: "";
    }

</style>
</head>

<body>
    @*<div class="row">
        <button class="layui-btn" type="button" onclick="ChaKan()">查看</button>
    </div>*@
    <div class="row">
        <input type="hidden" id="MyUnitID" value="" />
        <div class="col-xs-4 col-xs-offset-4">
            <div id="Segmentation" class="" style="margin-top:10px">
                <div id="tree" style="width:100%;">
                    <ul></ul>
                </div>
            </div>
        </div>

    </div>
    <div id="myMasks">
        <div id="ai" style="position: relative; border-radius: 10px; width: 250px; height: 100px; margin-left: auto; margin-right: auto; margin-top: 10px; background-color: rgba(0,0,0,0.4); padding: 20px; }">
            <div id="foo" style="float:left; width: auto; height: auto; margin-top: 12px; margin-top: 28px; margin-left: 25px; "></div>
            <label id="myMasksText" style="color: #fff; font-size: 18px; float: left; margin-left: 40px;  margin-top: 15px; ">正在加载，请稍等</label>
        </div>
    </div>
</body>
</html>
<script>
    var eHeight = $(window).height() - 64;
    $("#Segmentation").height(eHeight);
    $("#Segmentation2").height(eHeight);
    GetTree();

    //获取tree数据
    function GetTree() {
        $.ajax({
            url: "/Admin/GetUnit2",
            type: "post",
            dataType: "json",
            success: function (data) {
                //console.log(data);
                data = jQuery.parseJSON(data);
                console.log(data);
                var defaultData = data;
                $('#tree').treeview({
                    data: defaultData,
                    icon	:"",
                    showTags: true,
                    selectedColor: "#ffffff",
                    ExpandDepth: '0',
                    //nodeIcon: 'glyphicon glyphicon-stop',
                    emptyIcon: 'glyphicon glyphicon-stop',
                });
            }
        })
    }

    //树节点点击事件
    function itemOnclick(target) {
        var nodeid = $(target).attr('data-nodeid');
        var parentNode = $(target).parent().parent().attr("id");
        var node = $("#" + parentNode).treeview('getNode', nodeid);
        console.log(node.id);
        $("#MyUnitID").val(node.id);
        ChaKan();
        loading();
       // console.log(node2.id);
        //if (node.id == "" && node2.id != "") {
        //    $("#MyUnitID").val(node2.id);
        //} else if (node.id != "" && node2.id == "") {
        //    $("#MyUnitID").val(node.id);
        //} else if (node.id != "" && node2.id != "") {
        //    alert("请勿选中多个单位、部门");
        //}
    }
    //查看
    function ChaKan() {
        if ($("#MyUnitID").val() == "") {
            alert("请先选择部门");
        } else {
            console.log($("#MyUnitID").val());
            window.location.href = "/Unit/Detail?ID=" + $("#MyUnitID").val() + "";
        }
    }
    function loading() {
        $("#myMasks").fadeIn(300);
        var height = $(window).height() + "px";
        $("#myMasks").height($(window).height());
        //
        $("#ai").css("top", $(window).height() / 2 - 100);
        var opts = {
            lines: 13, //The number of lines to draw   菊花瓣的数目
            length: 7, //The length of each line   菊花瓣的长度
            width: 4, //The line thickness   菊花瓣的宽度
            radius: 10, //The radius of the inner circle   菊花中心的半径
            corners: 1, //Corner roundness (0..1)   菊花瓣的圆滑度(0--1)
            rotate: 0, //The rotation offset   让菊花旋转的角度
            color: '#fff', //#rgb or #rrggbb   菊花的颜色
            speed: 1, //Rounds per second   菊花旋转的速度
            trail: 60, //Afterglow percentage   菊花旋转时的余辉
            shadow: false, //Whether to render a shadow   是否需要菊花的阴影
            hwaccel: false, //Whether to use hardware acceleration   是否需要菊花高速旋转(硬件加速)
            className: 'spinner', //The CSS class to assign to the spinner   菊花的classname
            zIndex: 2e9, //The z-index (defaults to 2000000000)   菊花的z-index值
            top: 'auto', //Top position relative to parent in px   菊花相对定位的top
            left: 'auto' //Left position relative to parent in px  菊花相对定位的left
        };
        var target = document.getElementById('foo');
        spinner = new Spinner(opts).spin(target);
    }
</script>